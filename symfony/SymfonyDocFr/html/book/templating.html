

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Créer et utiliser les templates &mdash; sf2doc 1.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="sf2doc 1.0 documentation" href="../index.html" />
    <link rel="up" title="Book" href="index.html" />
    <link rel="next" title="Doctrine et les bases de données (« Le Modèle »)" href="doctrine.html" />
    <link rel="prev" title="Routage" href="routing.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="doctrine.html" title="Doctrine et les bases de données (« Le Modèle »)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="routing.html" title="Routage"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">sf2doc 1.0 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Book</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="creer-et-utiliser-les-templates">
<span id="index-0"></span><h1>Créer et utiliser les templates<a class="headerlink" href="#creer-et-utiliser-les-templates" title="Permalink to this headline">¶</a></h1>
<p>Comme vous le savez, le <a class="reference internal" href="controller.html"><em>contrôleur</em></a> est
responsable de la gestion de toute les requêtes d&#8217;une application
Symfony2. En réalité, le contrôleur délègue le plus gros du travail à
d&#8217;autres classes afin que le code puisse être testé et
réutilisé. Quand un contrôleur a besoin de générer du HTML, CSS ou
tout autre contenu, il donne la main au moteur de template.  Dans ce
chapitre, vous apprendrez comment écrire des templates puissants qui
peuvent être utilisés pour retourner du contenu à l&#8217;utilisateur,
remplir le corps d&#8217;emails et bien d&#8217;autres. Vous apprendrez des
raccourcis, des méthodes ingénieuses pour étendre les templates et
surtout comment les réutiliser.</p>
<div class="section" id="templates">
<span id="index-1"></span><h2>Templates<a class="headerlink" href="#templates" title="Permalink to this headline">¶</a></h2>
<p>Un template est un simple fichier texte qui peut génerer n&#8217;importe quel format
basé sur du texte (HTML, XML, CSV, LaTeX ...). Le type de template le plus connu
est le template <em>PHP</em> - un fichier texte interpreté par PHP qui contient du texte
et du code PHP:</p>
<div class="highlight-python"><pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;Bienvenue sur Symfony !&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;h1&gt;&lt;?php echo $page_title ?&gt;&lt;/h1&gt;

        &lt;ul id="navigation"&gt;
            &lt;?php foreach ($navigation as $item): ?&gt;
                &lt;li&gt;
                    &lt;a href="&lt;?php echo $item-&gt;getHref() ?&gt;"&gt;
                        &lt;?php echo $item-&gt;getCaption() ?&gt;
                    &lt;/a&gt;
                &lt;/li&gt;
            &lt;?php endforeach; ?&gt;
        &lt;/ul&gt;
    &lt;/body&gt;
&lt;/html&gt;</pre>
</div>
<p id="index-2">Mais Symfony2 contient un langage de template encore plus puissant appelé <a class="reference external" href="http://twig.sensiolabs.org">Twig</a>.
Twig vous permet d&#8217;écrire des templates simples et lisibles qui sont plus
compréhensibles par les web designers et, dans bien des aspects, plus puissants
que les templates PHP :</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        <span class="nt">&lt;title&gt;</span>Bienvenue sur Symfony !<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>
        <span class="nt">&lt;h1&gt;</span><span class="cp">{{</span> <span class="nv">page_title</span> <span class="cp">}}</span><span class="nt">&lt;/h1&gt;</span>

        <span class="nt">&lt;ul</span> <span class="na">id=</span><span class="s">&quot;navigation&quot;</span><span class="nt">&gt;</span>
            <span class="cp">{%</span> <span class="k">for</span> <span class="nv">item</span> <span class="k">in</span> <span class="nv">navigation</span> <span class="cp">%}</span>
                <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">item.href</span> <span class="cp">}}</span><span class="s">&quot;</span><span class="nt">&gt;</span><span class="cp">{{</span> <span class="nv">item.caption</span> <span class="cp">}}</span><span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
            <span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
        <span class="nt">&lt;/ul&gt;</span>
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>
</div>
<p>Twig définit deux types de syntaxe spéciale :</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">{{</span> <span class="pre">...</span> <span class="pre">}}</span></tt>: « Dit quelque chose »: écrit une variable ou le résultat d&#8217;une
expression  dans le template ;</li>
<li><tt class="docutils literal"><span class="pre">{%</span> <span class="pre">...</span> <span class="pre">%}</span></tt>: « Fait quelque chose »: un <strong>tag</strong> qui contrôle la logique
du template ; il est utilisé pour exécuter des instructions comme la boucle
for par exemple.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Il y a une troisième syntaxe utilisée pour les commentaires : <tt class="docutils literal"><span class="pre">{#</span> <span class="pre">un</span> <span class="pre">commentaire</span> <span class="pre">#}</span></tt>.
Cette syntaxe peut être utilisée sur plusieurs lignes comme la syntaxe PHP
<tt class="docutils literal"><span class="pre">/*</span> <span class="pre">commentaire</span> <span class="pre">*/</span></tt> qui est équivalente.</p>
</div>
<p>Twig contient également des <strong>filtres</strong>, qui modifient le contenu avant de le rendre.
Le filtre suivant met la variable <tt class="docutils literal"><span class="pre">title</span></tt> en majuscule avant de la rendre :</p>
<div class="highlight-jinja"><div class="highlight"><pre><span class="cp">{{</span> <span class="nv">title</span> <span class="o">|</span> <span class="nf">upper</span> <span class="cp">}}</span><span class="x"></span>
</pre></div>
</div>
<p>Twig est fourni avec une longue liste de <a class="reference external" href="http://twig.sensiolabs.org/doc/tags/index.html">tags</a> et de <a class="reference external" href="http://twig.sensiolabs.org/doc/filters/index.html">filtres</a> qui sont disponibles
par défaut. Vous pouvez même <a class="reference external" href="http://twig.sensiolabs.org/doc/extensions.html">ajouter vos propres extensions</a> à Twig si besoin.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Créer une nouvelle extension Twig est aussi simple que de créer un nouveau
service et de le tagger avec <tt class="docutils literal"><span class="pre">twig.extension</span></tt> <a class="reference internal" href="../reference/dic_tags.html#reference-dic-tags-twig-extension"><em>tag</em></a>.</p>
</div>
<p>Comme vous le verrez tout au long de la documentation, Twig supporte aussi les
fonctions, et de nouvelles fonctions peuvent être ajoutées. Par exemple, la fonction
suivante utilise le tag standard <tt class="docutils literal"><span class="pre">for</span></tt> et la fonction <tt class="docutils literal"><span class="pre">cycle</span></tt> pour écrire dix
balises div en alternant les classes <tt class="docutils literal"><span class="pre">odd</span></tt> et <tt class="docutils literal"><span class="pre">even</span></tt> :</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">for</span> <span class="nv">i</span> <span class="k">in</span> <span class="m">0.</span><span class="nv">.10</span> <span class="cp">%}</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">cycle</span><span class="o">([</span><span class="s1">&#39;odd&#39;</span><span class="o">,</span> <span class="s1">&#39;even&#39;</span><span class="o">],</span> <span class="nv">i</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- some HTML here --&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>Tout au long de ce chapitre, les exemples de templates seront donnés à la fois
avec Twig et PHP.</p>
<div class="sidebar">
<p class="first sidebar-title">Pourquoi Twig?</p>
<p>Les templates Twig sont conçus pour être simples et ne traiteront
aucun code PHP. De par sa conception, le système de template Twig
s&#8217;occupe de la présentation, pas de la logique. Plus vous
utiliserez Twig, plus vous apprécierez cette distinction et en
bénéficierez. Et bien sûr, vous serez adoré par tous les web
designers.</p>
<p>Twig peut aussi faire des choses que PHP ne pourrait pas faire, comme du vrai
héritage de templates (Twig compile les templates en classes PHP qui héritent
les unes des autres), le contrôle d&#8217;espace, le bac à sable et l&#8217;inclusion de
fonctions et de filtres personnalisés qui n&#8217;affectent que les templates. Twig
contient de petites fonctionnalités qui rendent l&#8217;écriture de template plus
facile et plus concise. Prenez l&#8217;exemple suivant, il combine une boucle avec
l&#8217;instruction logique <tt class="docutils literal"><span class="pre">if</span></tt> :</p>
<div class="last highlight-html+jinja"><div class="highlight"><pre><span class="nt">&lt;ul&gt;</span>
    <span class="cp">{%</span> <span class="k">for</span> <span class="nv">user</span> <span class="k">in</span> <span class="nv">users</span> <span class="cp">%}</span>
        <span class="nt">&lt;li&gt;</span><span class="cp">{{</span> <span class="nv">user.username</span> <span class="cp">}}</span><span class="nt">&lt;/li&gt;</span>
    <span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span>
        <span class="nt">&lt;li&gt;</span>Aucun utilisateur trouvé.<span class="nt">&lt;/li&gt;</span>
    <span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
<span class="nt">&lt;/ul&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="twig-et-la-mise-en-cache">
<span id="index-3"></span><h3>Twig et la mise en cache<a class="headerlink" href="#twig-et-la-mise-en-cache" title="Permalink to this headline">¶</a></h3>
<p>Twig est rapide. Chaque template Twig est compilé en une classe PHP natif qui est
rendue à l&#8217;éxécution. Les classes compilées sont stockées dans le répertoire
<tt class="docutils literal"><span class="pre">app/cache/{environment}/twig</span></tt> (où <tt class="docutils literal"><span class="pre">{environment}</span></tt> est l&#8217;environnement, par
exemple <tt class="docutils literal"><span class="pre">dev</span></tt> ou <tt class="docutils literal"><span class="pre">prod</span></tt>) et elles peuvent être utiles dans certains cas pour
débugguer. Lisez le chapitre <a class="reference internal" href="page_creation.html#environments-summary"><em>Environnements</em></a> pour plus d&#8217;informations
sur les environnements.</p>
<p>Lorsque le mode <tt class="docutils literal"><span class="pre">debug</span></tt> est activé (par exemple en environnement de <tt class="docutils literal"><span class="pre">dev</span></tt>),
un template Twig sera automatiquement recompilé à chaque fois qu&#8217;un changement y
sera apporté. Cela signifie que durant le développement, vous pouvez effectuer des
modifications dans un template Twig et voir instantanément les changements sans vous
soucier de vider le cache.</p>
<p>Lorsque le mode <tt class="docutils literal"><span class="pre">debug</span></tt> est désactivé (par exemple en environnement de <tt class="docutils literal"><span class="pre">prod</span></tt>),
en revanche, vous devrez vider le répertoire de cache Twig afin que le template soit
regénéré. Souvenez vous bien de cela lorsque vous déploirez votre application.</p>
</div>
</div>
<div class="section" id="l-heritage-de-template-et-layouts">
<span id="index-4"></span><h2>L&#8217;héritage de template et layouts<a class="headerlink" href="#l-heritage-de-template-et-layouts" title="Permalink to this headline">¶</a></h2>
<p>Bien souvent, les templates d&#8217;un projet partagent des éléments communs, comme les
entêtes, pieds de page et menus latéraux. Dans Symfony2, nous abordons ce problème
différemment : un template peut être décoré par un autre. Cela fonctionne exactement
comme les classes PHP : l&#8217;héritage de template vous permet de batir un template
« layout » de base qui contient tous les éléments communs de votre site et de définir
des <strong>blocs</strong> (comprenez « classe PHP avec des méthodes de base »). Un template
enfant peut étendre le template layout et surcharger n&#8217;importe lequel de ses blocs
(comprenez « une sous-classe PHP qui surcharge certaines méthodes de sa classe parente »).</p>
<p>Tout d&#8217;abord, construisez un fichier layout :</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-html+jinja"><div class="highlight"><pre><span class="c">{# app/Resources/views/base.html.twig #}</span>
<span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">&quot;Content-Type&quot;</span> <span class="na">content=</span><span class="s">&quot;text/html; charset=utf-8&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;title&gt;</span><span class="cp">{%</span> <span class="k">block</span> <span class="nv">title</span> <span class="cp">%}</span>Test Application<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span><span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;sidebar&quot;</span><span class="nt">&gt;</span>
            <span class="cp">{%</span> <span class="k">block</span> <span class="nv">sidebar</span> <span class="cp">%}</span>
            <span class="nt">&lt;ul&gt;</span>
                <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;/&quot;</span><span class="nt">&gt;</span>Home<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
                <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;/blog&quot;</span><span class="nt">&gt;</span>Blog<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
            <span class="nt">&lt;/ul&gt;</span>
            <span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
        <span class="nt">&lt;/div&gt;</span>

        <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;content&quot;</span><span class="nt">&gt;</span>
            <span class="cp">{%</span> <span class="k">block</span> <span class="nv">body</span> <span class="cp">%}{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="x">&lt;!-- app/Resources/views/base.html.php --&gt;</span>
<span class="x">&lt;!DOCTYPE html&gt;</span>
<span class="x">&lt;html&gt;</span>
<span class="x">    &lt;head&gt;</span>
<span class="x">        &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</span>
<span class="x">        &lt;title&gt;</span><span class="cp">&lt;?php</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;slots&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">output</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;Test Application&#39;</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="x">&lt;/title&gt;</span>
<span class="x">    &lt;/head&gt;</span>
<span class="x">    &lt;body&gt;</span>
<span class="x">        &lt;div id=&quot;sidebar&quot;&gt;</span>
<span class="x">            </span><span class="cp">&lt;?php</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;slots&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">has</span><span class="p">(</span><span class="s1">&#39;sidebar&#39;</span><span class="p">)</span><span class="o">:</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">                </span><span class="cp">&lt;?php</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;slots&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">output</span><span class="p">(</span><span class="s1">&#39;sidebar&#39;</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">            </span><span class="cp">&lt;?php</span> <span class="k">else</span><span class="o">:</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">                &lt;ul&gt;</span>
<span class="x">                    &lt;li&gt;&lt;a href=&quot;/&quot;&gt;Home&lt;/a&gt;&lt;/li&gt;</span>
<span class="x">                    &lt;li&gt;&lt;a href=&quot;/blog&quot;&gt;Blog&lt;/a&gt;&lt;/li&gt;</span>
<span class="x">                &lt;/ul&gt;</span>
<span class="x">            </span><span class="cp">&lt;?php</span> <span class="k">endif</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">        &lt;/div&gt;</span>

<span class="x">        &lt;div id=&quot;content&quot;&gt;</span>
<span class="x">            </span><span class="cp">&lt;?php</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;slots&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">output</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">    &lt;/body&gt;</span>
<span class="x">&lt;/html&gt;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Bien que les explications sur l&#8217;héritage de template concernent Twig, la
philosophie est la même pour les templates PHP.</p>
</div>
<p>Ce template définit le squelette HTML de base d&#8217;un document constitué simplement
de deux colonnes. Dans cette exemple, trois espaces <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">block</span> <span class="pre">%}</span></tt> sont définis
(<tt class="docutils literal"><span class="pre">title</span></tt>, <tt class="docutils literal"><span class="pre">sidebar</span></tt> et <tt class="docutils literal"><span class="pre">body</span></tt>). Chacun de ces blocs peut être soit
surchargé dans un template enfant ou soit conserver leur code d&#8217;origine. Ce
template peut aussi être rendu directement. Dans ce cas, les blocs <tt class="docutils literal"><span class="pre">title</span></tt>,
<tt class="docutils literal"><span class="pre">sidebar</span></tt> et <tt class="docutils literal"><span class="pre">body</span></tt> conserveront simplement les valeurs par défaut
utilisées dans ce template.</p>
<p>Un template enfant peut ressembler à cela :</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-html+jinja"><div class="highlight"><pre><span class="c">{# src/Acme/BlogBundle/Resources/views/Blog/index.html.twig #}</span>
<span class="cp">{%</span> <span class="k">extends</span> <span class="s1">&#39;::base.html.twig&#39;</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">title</span> <span class="cp">%}</span>My cool blog posts<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">body</span> <span class="cp">%}</span>
    <span class="cp">{%</span> <span class="k">for</span> <span class="nv">entry</span> <span class="k">in</span> <span class="nv">blog_entries</span> <span class="cp">%}</span>
        <span class="nt">&lt;h2&gt;</span><span class="cp">{{</span> <span class="nv">entry.title</span> <span class="cp">}}</span><span class="nt">&lt;/h2&gt;</span>
        <span class="nt">&lt;p&gt;</span><span class="cp">{{</span> <span class="nv">entry.body</span> <span class="cp">}}</span><span class="nt">&lt;/p&gt;</span>
    <span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="x">&lt;!-- src/Acme/BlogBundle/Resources/views/Blog/index.html.php --&gt;</span>
<span class="cp">&lt;?php</span> <span class="nv">$view</span><span class="o">-&gt;</span><span class="na">extend</span><span class="p">(</span><span class="s1">&#39;::base.html.php&#39;</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="x"></span>

<span class="cp">&lt;?php</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;slots&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;My cool blog posts&#39;</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="x"></span>

<span class="cp">&lt;?php</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;slots&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">start</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">    </span><span class="cp">&lt;?php</span> <span class="k">foreach</span> <span class="p">(</span><span class="nv">$blog_entries</span> <span class="k">as</span> <span class="nv">$entry</span><span class="p">)</span><span class="o">:</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">        &lt;h2&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$entry</span><span class="o">-&gt;</span><span class="na">getTitle</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="x">&lt;/h2&gt;</span>
<span class="x">        &lt;p&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$entry</span><span class="o">-&gt;</span><span class="na">getBody</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="x">&lt;/p&gt;</span>
<span class="x">    </span><span class="cp">&lt;?php</span> <span class="k">endforeach</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="cp">&lt;?php</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;slots&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">stop</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Le template parent est identifié grâce à une chaine de caractères
particulière (<tt class="docutils literal"><span class="pre">::base.html.twig</span></tt>) qui indique que ce template se trouve
dans le dossier <tt class="docutils literal"><span class="pre">app/Resources/views</span></tt> du projet. Cette convention de
nommage est complètement expliquée dans <a class="reference internal" href="#template-naming-locations"><em>Nommage de template et Emplacements</em></a>.</p>
</div>
<p>La clé de l&#8217;héritage de template est la balise <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">extends</span> <span class="pre">%}</span></tt>. Elle indique
au moteur de template d&#8217;évaluer d&#8217;abord le template de base, qui configure le
layout et définit plusieurs blocs. Le template enfant est ensuite
rendu. Durant ce traitement les blocs parents <tt class="docutils literal"><span class="pre">title</span></tt> et <tt class="docutils literal"><span class="pre">body</span></tt> sont
remplacés par ceux de l&#8217;enfant. Dépendant de la valeur de <tt class="docutils literal"><span class="pre">blog_entries</span></tt>, la
sortie peut ressembler à ceci :</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">&quot;Content-Type&quot;</span> <span class="na">content=</span><span class="s">&quot;text/html; charset=utf-8&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;title&gt;</span>Mes billets de blog cools<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;sidebar&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;ul&gt;</span>
                <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;/&quot;</span><span class="nt">&gt;</span>Accueil<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
                <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;/blog&quot;</span><span class="nt">&gt;</span>Blog<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
            <span class="nt">&lt;/ul&gt;</span>
        <span class="nt">&lt;/div&gt;</span>

        <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;content&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;h2&gt;</span>Mon premier post<span class="nt">&lt;/h2&gt;</span>
            <span class="nt">&lt;p&gt;</span>Le corps du premier post.<span class="nt">&lt;/p&gt;</span>

            <span class="nt">&lt;h2&gt;</span>Un autre post<span class="nt">&lt;/h2&gt;</span>
            <span class="nt">&lt;p&gt;</span>Le corps du deuxième post.<span class="nt">&lt;/p&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>
</div>
<p>Remarquons que comme le template enfant n&#8217;a pas défini le bloc <tt class="docutils literal"><span class="pre">sidebar</span></tt>, la
valeur du template parent est utilisé à la place. Le contenu d&#8217;une balise
<tt class="docutils literal"><span class="pre">{%</span> <span class="pre">block</span> <span class="pre">%}</span></tt> d&#8217;un template parent est toujours utilisé par défaut.</p>
<p>Vous pouvez utiliser autant de niveaux d&#8217;héritage que vous souhaitez. Dans la
section suivante, un modèle commun d&#8217;héritage à trois niveaux sera expliqué,
ainsi que l&#8217;organisation des templates au sein d&#8217;un projet Symfony2.</p>
<p>Quand on travaille avec l&#8217;héritage de templates, il est important de garder ces
astuces à l&#8217;esprit :</p>
<ul>
<li><p class="first">Si vous utilisez <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">extends</span> <span class="pre">%}</span></tt> dans un template, alors ce doit être la
première balise de ce template.</p>
</li>
<li><p class="first">Plus vous utilisez les balises <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">block</span> <span class="pre">%}</span></tt> dans les templates, mieux
c&#8217;est. Souvenez-vous, les templates enfants ne doivent pas obligatoirement
définir tous les blocs parents, donc créez autant de blocs que vous
désirez dans le template de base et attribuez leurs une configuration par
défaut. Plus vous avez de blocs dans le template de base, plus le layout
sera flexible.</p>
</li>
<li><p class="first">Si vous vous retrouvez à dupliquer du contenu dans plusieurs templates, cela
veut probablement dire que vous devriez déplacer ce contenu dans un
<tt class="docutils literal"><span class="pre">{%</span> <span class="pre">block</span>&nbsp; <span class="pre">%}</span></tt> d&#8217;un template parent. Dans certain cas, la meilleur solution
peut être de déplacer le contenu dans un nouveau template et de l&#8217;<tt class="docutils literal"><span class="pre">include</span></tt>
(voir <a class="reference internal" href="#including-templates"><em>L&#8217;inclusion de Templates</em></a>).</p>
</li>
<li><p class="first">Si vous avez besoin de récupérer le contenu d&#8217;un bloc d&#8217;un template parent,
vous pouvez utiliser la fonction <tt class="docutils literal"><span class="pre">{{</span> <span class="pre">parent()</span> <span class="pre">}}</span></tt>. C&#8217;est utile si on
souhaite compléter le contenu du bloc parent au lieu de le réécrire
totalement :</p>
<blockquote>
<div><div class="highlight-html+jinja"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">block</span> <span class="nv">sidebar</span> <span class="cp">%}</span>
    <span class="nt">&lt;h3&gt;</span>Table of Contents<span class="nt">&lt;/h3&gt;</span>
    ...
    <span class="cp">{{</span> <span class="nv">parent</span><span class="o">()</span> <span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="nommage-de-template-et-emplacements">
<span id="template-naming-locations"></span><span id="index-5"></span><h2>Nommage de template et Emplacements<a class="headerlink" href="#nommage-de-template-et-emplacements" title="Permalink to this headline">¶</a></h2>
<p>Par défaut, les templates peuvent se trouver dans deux emplacements
différents :</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">app/Resources/views/</span></tt> : Le dossier <tt class="docutils literal"><span class="pre">views</span></tt> de l&#8217;application peut
aussi bien contenir le template de base de l&#8217;application (c-a-d le layout de
l&#8217;application) ou les templates qui surchargent les templates des bundles
(voir <a class="reference internal" href="#overriding-bundle-templates"><em>La Surcharge de templates de Bundle</em></a>);</li>
<li><tt class="docutils literal"><span class="pre">path/to/bundle/Resources/views/</span></tt> : Chaque bundle place leurs
templates dans leur dossier <tt class="docutils literal"><span class="pre">Resources/views</span></tt> (et sous dossiers). La
plupart des templates résident au sein d&#8217;un bundle.</li>
</ul>
<p>Symfony2 utilise une chaine de caractères au format
<strong>bundle</strong>:<strong>controller</strong>:<strong>template</strong> pour les templates. Cela permet plusieurs
types de templates, chacun se situant à un endroit spécifique :</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">AcmeBlogBundle:Blog:index.html.twig</span></tt>: Cette syntaxe est utilisée pour
spécifier un template pour une page donnée. Les trois parties de la chaine de
caractères, séparées par deux-points (<tt class="docutils literal"><span class="pre">:</span></tt>), signifie ceci :</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">AcmeBlogBundle</span></tt>: (<em>bundle</em>) le template se trouve dans le
<tt class="docutils literal"><span class="pre">AcmeBlogBundle</span></tt> (<tt class="docutils literal"><span class="pre">src/Acme/BlogBundle</span></tt> par exemple);</li>
<li><tt class="docutils literal"><span class="pre">Blog</span></tt>: (<em>controller</em>) indique que le template se trouve dans le
sous-répertoire <tt class="docutils literal"><span class="pre">Blog</span></tt> de <tt class="docutils literal"><span class="pre">Resources/views</span></tt>;</li>
<li><tt class="docutils literal"><span class="pre">index.html.twig</span></tt>: (<em>template</em>) le nom réel du fichier est
<tt class="docutils literal"><span class="pre">index.html.twig</span></tt>.</li>
</ul>
</div></blockquote>
<p>En supposant que le <tt class="docutils literal"><span class="pre">AcmeBlogBundle</span></tt> se trouve à <tt class="docutils literal"><span class="pre">src/Acme/BlogBundle</span></tt>, le
chemin final du layout serait <tt class="docutils literal"><span class="pre">src/Acme/BlogBundle/Resources/views/Blog/index.html.twig</span></tt>.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">AcmeBlogBundle::layout.html.twig</span></tt>: Cette syntaxe fait référence à un
template de base qui est spécifique au <tt class="docutils literal"><span class="pre">AcmeBlogBundle</span></tt>. Puisque la partie du
milieu, « controller », est absente (<tt class="docutils literal"><span class="pre">Blog</span></tt> par exemple), le template se
trouve à <tt class="docutils literal"><span class="pre">Resources/views/layout.html.twig</span></tt> dans <tt class="docutils literal"><span class="pre">AcmeBlogBundle</span></tt>.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">::base.html.twig</span></tt>: Cette syntaxe fait référence à un template de base d&#8217;une
application ou layout. Remarquez que la chaine de caractères commence par deux
deux-points (<tt class="docutils literal"><span class="pre">::</span></tt>), ce qui signifie que les deux parties <em>bundle</em> et
<em>controller</em> sont absentes. Ce qui signifie que le template ne se trouve dans
aucun bundle, mais directement dans le répertoire racine
<tt class="docutils literal"><span class="pre">app/Resources/views/</span></tt>.</p>
</li>
</ul>
<p>Dans la section <a class="reference internal" href="#overriding-bundle-templates"><em>La Surcharge de templates de Bundle</em></a>, vous verrez comment les
templates intéragissent avec <tt class="docutils literal"><span class="pre">AcmeBlogBundle</span></tt>. Par exemple, il est possible de
surcharger un template en plaçant un template du même nom dans le répertoire
<tt class="docutils literal"><span class="pre">app/Resources/AcmeBlogBundle/views/</span></tt>. Cela offre la possibilité de surcharger
les templates fournis par n&#8217;importe quel vendor bundle.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">La syntaxe de nommage des templates doit vous paraitre familière -
c&#8217;est la même convention de nommage qui est utilisée pour faire référence à
<a class="reference internal" href="routing.html#controller-string-syntax"><em>Pattern de Nommage du Contrôleur</em></a>.</p>
</div>
<div class="section" id="les-suffixes-de-template">
<h3>Les Suffixes de Template<a class="headerlink" href="#les-suffixes-de-template" title="Permalink to this headline">¶</a></h3>
<p>Le format <strong>bundle</strong>:<strong>controller</strong>:<strong>template</strong> de chaque template spécifie
<em>où</em> se situe le fichier template. Chaque nom de template a aussi deux extensions
qui spécifient le <em>format</em> et le <em>moteur</em> (engine) pour le template.</p>
<ul class="simple">
<li><strong>AcmeBlogBundle:Blog:index.html.twig</strong> - format HTML, moteur de template Twig</li>
<li><strong>AcmeBlogBundle:Blog:index.html.php</strong> - format HTML, moteur de template PHP</li>
<li><strong>AcmeBlogBundle:Blog:index.css.twig</strong> - format CSS, moteur de template Twig</li>
</ul>
<p>Par défaut, tout template de Symfony2 peut être écrit soit en Twig ou en PHP, et
la dernière partie de l&#8217;extension (<tt class="docutils literal"><span class="pre">.twig</span></tt> ou <tt class="docutils literal"><span class="pre">.php</span></tt> par exemple) spécifie
lequel de ces deux <em>moteurs</em> sera utilisé. La première partie de l&#8217;extension
(<tt class="docutils literal"><span class="pre">.html</span></tt>, <tt class="docutils literal"><span class="pre">.css</span></tt> par exemple) désigne le format final du template qui sera
généré. Contrairement au moteur, qui détermine comment Symfony2 parsera le
template, il s&#8217;agit là simplement une méthode organisationnelle qui est utilisée dans le
cas où la même ressource a besoin d&#8217;être rendue en HTML (<tt class="docutils literal"><span class="pre">index.html.twig</span></tt>),
en XML (<tt class="docutils literal"><span class="pre">index.xml.twig</span></tt>), ou tout autre format. Pour plus d&#8217;informations,
lisez la section <a class="reference internal" href="#template-formats"><em>Les Formats de Template</em></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Les <em>moteurs</em> disponibles peuvent être configurés et d&#8217;autres moteurs peuvent
être ajoutés. Voir <a class="reference internal" href="#template-configuration"><em>Templating Configuration</em></a>
pour plus de détails.</p>
</div>
</div>
</div>
<div class="section" id="balises-et-helpers">
<span id="index-6"></span><h2>Balises et Helpers<a class="headerlink" href="#balises-et-helpers" title="Permalink to this headline">¶</a></h2>
<p>Vous avez maintenant compris les bases des templates, comment ils sont nommés et
comment utiliser l&#8217;héritage de templates. Les parties les plus difficiles sont
d&#8217;ores et déjà derrière vous. Dans cette section, vous apprendrez à utiliser un
ensemble d&#8217;outils disponibles pour aider à réaliser les tâches les plus communes
avec les templates comme l&#8217;inclusion de templates, faire des liens entre des
pages et l&#8217;inclusion d&#8217;images.</p>
<p>Symfony2 regroupe plusieurs paquets dont plusieurs spécialisés dans les balises
et fonctions Twig qui facilitent le travail du web designer. En PHP, le
système de templates fournit un système de <em>helper</em> extensible. Ce système fournit des
propriétés utiles dans le contexte des templates.</p>
<p>Nous avons déjà vu quelques balises Twig (<tt class="docutils literal"><span class="pre">{%</span> <span class="pre">block</span> <span class="pre">%}</span></tt> &amp; <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">extends</span> <span class="pre">%}</span></tt>)
ainsi qu&#8217;un exemple de helper PHP (<tt class="docutils literal"><span class="pre">$view['slots']</span></tt>). Apprenons en un peu
plus.</p>
<div class="section" id="l-inclusion-de-templates">
<span id="including-templates"></span><span id="index-7"></span><h3>L&#8217;inclusion de Templates<a class="headerlink" href="#l-inclusion-de-templates" title="Permalink to this headline">¶</a></h3>
<p>Vous voudrez souvent inclure le même template ou fragment de code dans
différentes pages. Par exemple, dans une application avec un espace « nouveaux
articles », le code du template affichant un article peut être utilisé sur la
page détaillant l&#8217;article, sur une page affichant les articles les plus
populaires, ou dans une liste des derniers articles.</p>
<p>Quand vous avez besoin de réutiliser une grand partie d&#8217;un code PHP,
typiquement vous déplacez le code dans une nouvelle classe PHP ou dans
une fonction. La même chose s&#8217;applique aussi aux templates. En
déplaçant le code réutilisé dans son propre template, il peut être
inclu par tous les autres templates. D&#8217;abord, créez le template que
vous souhaiterez réutiliser.</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-html+jinja"><div class="highlight"><pre><span class="c">{# src/Acme/ArticleBundle/Resources/views/Article/articleDetails.html.twig #}</span>
<span class="nt">&lt;h2&gt;</span><span class="cp">{{</span> <span class="nv">article.title</span> <span class="cp">}}</span><span class="nt">&lt;/h2&gt;</span>
<span class="nt">&lt;h3</span> <span class="na">class=</span><span class="s">&quot;byline&quot;</span><span class="nt">&gt;</span>by <span class="cp">{{</span> <span class="nv">article.authorName</span> <span class="cp">}}</span><span class="nt">&lt;/h3&gt;</span>

<span class="nt">&lt;p&gt;</span>
  <span class="cp">{{</span> <span class="nv">article.body</span> <span class="cp">}}</span>
<span class="nt">&lt;/p&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="x">&lt;!-- src/Acme/ArticleBundle/Resources/views/Article/articleDetails.html.php --&gt;</span>
<span class="x">&lt;h2&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$article</span><span class="o">-&gt;</span><span class="na">getTitle</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="x">&lt;/h2&gt;</span>
<span class="x">&lt;h3 class=&quot;byline&quot;&gt;by </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$article</span><span class="o">-&gt;</span><span class="na">getAuthorName</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="x">&lt;/h3&gt;</span>

<span class="x">&lt;p&gt;</span>
<span class="x">  </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$article</span><span class="o">-&gt;</span><span class="na">getBody</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">&lt;/p&gt;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>L&#8217;inclusion de ce template dans tout autre template est simple :</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-html+jinja"><div class="highlight"><pre><span class="c">{# src/Acme/ArticleBundle/Resources/Article/list.html.twig #}</span>
<span class="cp">{%</span> <span class="k">extends</span> <span class="s1">&#39;AcmeArticleBundle::layout.html.twig&#39;</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">body</span> <span class="cp">%}</span>
    <span class="nt">&lt;h1&gt;</span>Recent Articles<span class="nt">&lt;h1&gt;</span>

    <span class="cp">{%</span> <span class="k">for</span> <span class="nv">article</span> <span class="k">in</span> <span class="nv">articles</span> <span class="cp">%}</span>
        <span class="cp">{%</span> <span class="k">include</span> <span class="s1">&#39;AcmeArticleBundle:Article:articleDetails.html.twig&#39;</span> <span class="k">with</span> <span class="o">{</span><span class="s1">&#39;article&#39;</span><span class="o">:</span> <span class="nv">article</span><span class="o">}</span> <span class="cp">%}</span>
    <span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="x">&lt;!-- src/Acme/ArticleBundle/Resources/Article/list.html.php --&gt;</span>
<span class="cp">&lt;?php</span> <span class="nv">$view</span><span class="o">-&gt;</span><span class="na">extend</span><span class="p">(</span><span class="s1">&#39;AcmeArticleBundle::layout.html.php&#39;</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="x"></span>

<span class="cp">&lt;?php</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;slots&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">start</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">    &lt;h1&gt;Recent Articles&lt;/h1&gt;</span>

<span class="x">    </span><span class="cp">&lt;?php</span> <span class="k">foreach</span> <span class="p">(</span><span class="nv">$articles</span> <span class="k">as</span> <span class="nv">$article</span><span class="p">)</span><span class="o">:</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">        </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="o">-&gt;</span><span class="na">render</span><span class="p">(</span><span class="s1">&#39;AcmeArticleBundle:Article:articleDetails.html.php&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;article&#39;</span> <span class="o">=&gt;</span> <span class="nv">$article</span><span class="p">))</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">    </span><span class="cp">&lt;?php</span> <span class="k">endforeach</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="cp">&lt;?php</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;slots&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">stop</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Le template est inclu via l&#8217;utilisation de la balise <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">include</span> <span class="pre">%}</span></tt>.
Remarquons que le nom du template suit la même convention habituelle. Le
template <tt class="docutils literal"><span class="pre">articleDetails.html.twig</span></tt> utilise une variable <tt class="docutils literal"><span class="pre">article</span></tt>. Elle est
passée au template <tt class="docutils literal"><span class="pre">list.html.twig</span></tt> en utilisant la commande <tt class="docutils literal"><span class="pre">with</span></tt>.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">La syntaxe <tt class="docutils literal"><span class="pre">{'article':</span> <span class="pre">article}</span></tt> est la syntaxe standard de Twig pour les
tables de hachage (hash maps) (c-a-d un tableau clé-valeurs). Si nous souhaitons
passer plusieurs elements, cela ressemblera à ceci : <tt class="docutils literal"><span class="pre">{'foo':</span> <span class="pre">foo,</span> <span class="pre">'bar':</span> <span class="pre">bar}</span></tt>.</p>
</div>
</div>
<div class="section" id="controleurs-imbriques">
<span id="templating-embedding-controller"></span><span id="index-8"></span><h3>Contrôleurs imbriqués<a class="headerlink" href="#controleurs-imbriques" title="Permalink to this headline">¶</a></h3>
<p>Dans certains cas, vous aurez besoin d&#8217;inclure plus qu&#8217;un simple
template. Supposons que vous avez un menu latéral dans votre layout qui contient
les trois articles les plus récents. La récupération des trois articles les plus
récents peut nécessiter l&#8217;inclusion d&#8217;une requête vers une base de données et de
réaliser d&#8217;autres oprérations logiques qui ne peuvent pas être effectuées dans
un template.</p>
<p>La solution consiste simplement à imbriquer les résultats d&#8217;un contrôleur dans un
template. Dans un premier temps, créez un contrôleur qui retourne un certain
nombre d&#8217;articles récents :</p>
<div class="highlight-php"><div class="highlight"><pre><span class="x">// src/Acme/ArticleBundle/Controller/ArticleController.php</span>

<span class="x">class ArticleController extends Controller</span>
<span class="x">{</span>
<span class="x">    public function recentArticlesAction($max = 3)</span>
<span class="x">    {</span>
<span class="x">        // un appel en base de données ou n&#39;importe quoi qui retourne les &quot;$max&quot; plus récents articles</span>
<span class="x">        $articles = ...;</span>

<span class="x">        return $this-&gt;render(&#39;AcmeArticleBundle:Article:recentList.html.twig&#39;, array(&#39;articles&#39; =&gt; $articles));</span>
<span class="x">    }</span>
<span class="x">}</span>
</pre></div>
</div>
<p>Le template <tt class="docutils literal"><span class="pre">recentList</span></tt> est simplement le suivant :</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-html+jinja"><div class="highlight"><pre><span class="c">{# src/Acme/ArticleBundle/Resources/views/Article/recentList.html.twig #}</span>
<span class="cp">{%</span> <span class="k">for</span> <span class="nv">article</span> <span class="k">in</span> <span class="nv">articles</span> <span class="cp">%}</span>
  <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;/article/</span><span class="cp">{{</span> <span class="nv">article.slug</span> <span class="cp">}}</span><span class="s">&quot;</span><span class="nt">&gt;</span>
      <span class="cp">{{</span> <span class="nv">article.title</span> <span class="cp">}}</span>
  <span class="nt">&lt;/a&gt;</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="x">&lt;!-- src/Acme/ArticleBundle/Resources/views/Article/recentList.html.php --&gt;</span>
<span class="cp">&lt;?php</span> <span class="k">foreach</span> <span class="p">(</span><span class="nv">$articles</span> <span class="k">as</span> <span class="nv">$article</span><span class="p">)</span><span class="o">:</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">    &lt;a href=&quot;/article/</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$article</span><span class="o">-&gt;</span><span class="na">getSlug</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="x">        </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$article</span><span class="o">-&gt;</span><span class="na">getTitle</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">    &lt;/a&gt;</span>
<span class="cp">&lt;?php</span> <span class="k">endforeach</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Remarquons que nous avons triché et que nous avons codé en dur les URLs des
articles dans cet exemple (<tt class="docutils literal"><span class="pre">/article/*slug*</span></tt> par exemple). Ce n&#8217;est pas
une bonne pratique. Dans la section suivante, vous apprendrez comment le
faire correctement.</p>
</div>
<p>Pour inclure le contrôleur, vous avez besoin de faire référence à ce dernier en
utilisant la chaine de caractères standard pour les contrôleurs
(c-a-d <strong>bundle</strong>:<strong>controller</strong>:<strong>action</strong>) :</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-html+jinja"><div class="highlight"><pre><span class="c">{# app/Resources/views/base.html.twig #}</span>
...

<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;sidebar&quot;</span><span class="nt">&gt;</span>
    <span class="cp">{%</span> <span class="k">render</span> <span class="s2">&quot;AcmeArticleBundle:Article:recentArticles&quot;</span> <span class="k">with</span> <span class="o">{</span><span class="s1">&#39;max&#39;</span><span class="o">:</span> <span class="m">3</span><span class="o">}</span> <span class="cp">%}</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="x">&lt;!-- app/Resources/views/base.html.php --&gt;</span>
<span class="x">...</span>

<span class="x">&lt;div id=&quot;sidebar&quot;&gt;</span>
<span class="x">    </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;actions&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">render</span><span class="p">(</span><span class="s1">&#39;AcmeArticleBundle:Article:recentArticles&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;max&#39;</span> <span class="o">=&gt;</span> <span class="mi">3</span><span class="p">))</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">&lt;/div&gt;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>A chaque fois que vous pensez avoir besoin d&#8217;une variable ou de quelques informations
auxquelles vous n&#8217;avez pas accès à partir d&#8217;un template, penser à rendre un
contrôleur. Les contrôleurs sont rapides à l&#8217;exécution et favorisent une bonne
organisation et réutilisabilité du code.</p>
</div>
<div class="section" id="liens-vers-des-pages">
<span id="index-9"></span><h3>Liens vers des Pages<a class="headerlink" href="#liens-vers-des-pages" title="Permalink to this headline">¶</a></h3>
<p>La création de liens vers d&#8217;autres pages de votre projet est l&#8217;opération la plus
commune qui soit dans un template. Au lieu de coder en dur les URLs dans les
templates, utilisez la fonction <tt class="docutils literal"><span class="pre">path</span></tt> de Twig (ou le helper <tt class="docutils literal"><span class="pre">router</span></tt> en
PHP) pour générer les URLs basées sur la configuration des routes. Plus tard, si
vous désirez modifier l&#8217;URL d&#8217;une page particulière, tout ce que vous avez
besoin de faire c&#8217;est changer la configuration des routes; les templates
génèreront automatiquement la nouvelle URL.</p>
<p>Dans un premier temps, configurons le lien vers la page « _welcome » qui est
accessible via la configuration de route suivante :</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">_welcome</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">pattern</span><span class="p-Indicator">:</span>  <span class="l-Scalar-Plain">/</span>
    <span class="l-Scalar-Plain">defaults</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">_controller</span><span class="p-Indicator">:</span> <span class="nv">AcmeDemoBundle</span><span class="p-Indicator">:</span><span class="nv">Welcome</span><span class="p-Indicator">:</span><span class="nv">index</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;route</span> <span class="na">id=</span><span class="s">&quot;_welcome&quot;</span> <span class="na">pattern=</span><span class="s">&quot;/&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;default</span> <span class="na">key=</span><span class="s">&quot;_controller&quot;</span><span class="nt">&gt;</span>AcmeDemoBundle:Welcome:index<span class="nt">&lt;/default&gt;</span>
<span class="nt">&lt;/route&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="x">$collection = new RouteCollection();</span>
<span class="x">$collection-&gt;add(&#39;_welcome&#39;, new Route(&#39;/&#39;, array(</span>
<span class="x">    &#39;_controller&#39; =&gt; &#39;AcmeDemoBundle:Welcome:index&#39;,</span>
<span class="x">)));</span>

<span class="x">return $collection;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Pour faire un lien vers cette page, utilisons simplement la fonction <tt class="docutils literal"><span class="pre">path</span></tt> de
Twig en faisant référence à cette route :</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-html+jinja"><div class="highlight"><pre><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">path</span><span class="o">(</span><span class="s1">&#39;_welcome&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span><span class="nt">&gt;</span>Home<span class="nt">&lt;/a&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="x">&lt;a href=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;router&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">generate</span><span class="p">(</span><span class="s1">&#39;_welcome&#39;</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;Home&lt;/a&gt;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Comme prévu, ceci génèrera l&#8217;URL <tt class="docutils literal"><span class="pre">/</span></tt>. Voyons comment cela fonctionne avec des
routes plus compliquées :</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">article_show</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">pattern</span><span class="p-Indicator">:</span>  <span class="l-Scalar-Plain">/article/{slug}</span>
    <span class="l-Scalar-Plain">defaults</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">_controller</span><span class="p-Indicator">:</span> <span class="nv">AcmeArticleBundle</span><span class="p-Indicator">:</span><span class="nv">Article</span><span class="p-Indicator">:</span><span class="nv">show</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;route</span> <span class="na">id=</span><span class="s">&quot;article_show&quot;</span> <span class="na">pattern=</span><span class="s">&quot;/article/{slug}&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;default</span> <span class="na">key=</span><span class="s">&quot;_controller&quot;</span><span class="nt">&gt;</span>AcmeArticleBundle:Article:show<span class="nt">&lt;/default&gt;</span>
<span class="nt">&lt;/route&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="x">$collection = new RouteCollection();</span>
<span class="x">$collection-&gt;add(&#39;article_show&#39;, new Route(&#39;/article/{slug}&#39;, array(</span>
<span class="x">    &#39;_controller&#39; =&gt; &#39;AcmeArticleBundle:Article:show&#39;,</span>
<span class="x">)));</span>

<span class="x">return $collection;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Dans ce cas, vous devrez spécifiez le nom de route (<tt class="docutils literal"><span class="pre">article_show</span></tt>) et une
valeur pour le paramètre <tt class="docutils literal"><span class="pre">{slug}</span></tt>. En utilisant cette route, revoyons le
template <tt class="docutils literal"><span class="pre">recentList</span></tt> de la section précédente, et
faisons les liens vers les articles correctement :</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-html+jinja"><div class="highlight"><pre><span class="c">{# src/Acme/ArticleBundle/Resources/views/Article/recentList.html.twig #}</span>
<span class="cp">{%</span> <span class="k">for</span> <span class="nv">article</span> <span class="k">in</span> <span class="nv">articles</span> <span class="cp">%}</span>
  <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">path</span><span class="o">(</span><span class="s1">&#39;article_show&#39;</span><span class="o">,</span> <span class="o">{</span> <span class="s1">&#39;slug&#39;</span><span class="o">:</span> <span class="nv">article.slug</span> <span class="o">})</span> <span class="cp">}}</span><span class="s">&quot;</span><span class="nt">&gt;</span>
      <span class="cp">{{</span> <span class="nv">article.title</span> <span class="cp">}}</span>
  <span class="nt">&lt;/a&gt;</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="x">&lt;!-- src/Acme/ArticleBundle/Resources/views/Article/recentList.html.php --&gt;</span>
<span class="cp">&lt;?php</span> <span class="k">foreach</span> <span class="p">(</span><span class="nv">$articles</span> <span class="k">as</span> <span class="nv">$article</span><span class="p">)</span><span class="o">:</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">    &lt;a href=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;router&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">generate</span><span class="p">(</span><span class="s1">&#39;article_show&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;slug&#39;</span> <span class="o">=&gt;</span> <span class="nv">$article</span><span class="o">-&gt;</span><span class="na">getSlug</span><span class="p">())</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="x">        </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$article</span><span class="o">-&gt;</span><span class="na">getTitle</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">    &lt;/a&gt;</span>
<span class="cp">&lt;?php</span> <span class="k">endforeach</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Vous pouvez aussi générer l&#8217;URL absolue en utilisant la fonction <tt class="docutils literal"><span class="pre">url</span></tt> de Twig :</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">url</span><span class="o">(</span><span class="s1">&#39;_welcome&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span><span class="nt">&gt;</span>Home<span class="nt">&lt;/a&gt;</span>
</pre></div>
</div>
<p>La même chose peut être réalisée dans les templates en PHP en passant un
troisième argument à la méthode <tt class="docutils literal"><span class="pre">generate()</span></tt> :</p>
<div class="last highlight-php"><div class="highlight"><pre><span class="x">&lt;a href=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;router&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">generate</span><span class="p">(</span><span class="s1">&#39;_welcome&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(),</span> <span class="k">true</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;Home&lt;/a&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="liens-vers-des-fichiers">
<span id="index-10"></span><h3>Liens vers des Fichiers<a class="headerlink" href="#liens-vers-des-fichiers" title="Permalink to this headline">¶</a></h3>
<p>Les templates font aussi très souvent référence à des images, du Javascript, des
feuilles de style et d&#8217;autres fichiers. Bien sûr vous pouvez coder en dur le chemin
vers ces fichiers (<tt class="docutils literal"><span class="pre">/images/logo.png</span></tt> par exemple), mais Symfony2 fournit une
façon de faire plus souple via la fonction <tt class="docutils literal"><span class="pre">assets</span></tt> de Twig :</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-html+jinja"><div class="highlight"><pre><span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">asset</span><span class="o">(</span><span class="s1">&#39;images/logo.png&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span> <span class="na">alt=</span><span class="s">&quot;Symfony!&quot;</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">asset</span><span class="o">(</span><span class="s1">&#39;css/blog.css&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="x">&lt;img src=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;assets&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">getUrl</span><span class="p">(</span><span class="s1">&#39;images/logo.png&#39;</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="x">&quot; alt=&quot;Symfony!&quot; /&gt;</span>

<span class="x">&lt;link href=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;assets&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">getUrl</span><span class="p">(</span><span class="s1">&#39;css/blog.css&#39;</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="x">&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; /&gt;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Le principal objectif de la fonction <tt class="docutils literal"><span class="pre">asset</span></tt> est de rendre votre application
plus portable. Si votre application se trouve à la racine de votre hôte
(<a class="reference external" href="http://example.com">http://example.com</a> par exemple), alors les chemins se retourné sera
<tt class="docutils literal"><span class="pre">/images/logo.png</span></tt>. Mais si votre application se trouve dans un sous
répertoire (<a class="reference external" href="http://example.com/my_app">http://example.com/my_app</a> par exemple), chaque chemin vers les
fichiers sera alors généré avec le sous répertoire (<tt class="docutils literal"><span class="pre">/my_app/images/logo.png</span></tt>
par exemple). La fonction <tt class="docutils literal"><span class="pre">asset</span></tt> fait attention à cela en déterminant comment
votre application est utilisée et en générant les chemins corrects.</p>
<p>De plus, si vous utilisez la fonction <tt class="docutils literal"><span class="pre">asset</span></tt>, Symfony peut automatiquement ajouter
une chaine de caractères afin de garantir que la ressource statique mise à jour ne
sera pas mise en cache lors de son déploiement. Par exemple, <tt class="docutils literal"><span class="pre">/images/logo.png</span></tt>
pourrait ressembler à <tt class="docutils literal"><span class="pre">/images/logo.png?v2</span></tt>. Pour plus d&#8217;informations, lisez
la documentation de l&#8217;option de configuration <a class="reference internal" href="../reference/configuration/framework.html#ref-framework-assets-version"><em>assets_version</em></a>.</p>
</div>
</div>
<div class="section" id="l-inclusion-de-feuilles-de-style-et-de-javascripts-avec-twig">
<span id="index-11"></span><h2>L&#8217;inclusion de Feuilles de style et de Javascripts avec Twig<a class="headerlink" href="#l-inclusion-de-feuilles-de-style-et-de-javascripts-avec-twig" title="Permalink to this headline">¶</a></h2>
<p>Aucun site n&#8217;est complet sans inclure des fichiers Javascript et des feuilles de
styles. Dans Symfony, l&#8217;inclusion de ces fichiers est gérée d&#8217;une façon élégante en
conservant les avantages du mécanisme d&#8217;héritage de templates de Symfony.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Cette section vous apprendra la philosophie qui existe derrière l&#8217;inclusion
de feuilles de style et de fichiers Javascript dans Symfony. Symfony contient
aussi une autre bibliothèque, appelée Assetic, qui suit la même philosophie
mais vous permet de faire des choses plus intéressantes avec ces
fichiers. Pour plus d&#8217;informations sur le sujet voir
<a class="reference internal" href="../cookbook/assetic/asset_management.html"><em>How to Use Assetic for Asset Management</em></a>.</p>
</div>
<p>Commencons par ajouter deux blocs à notre template de base qui incluront deux
fichiers : l&#8217;un s&#8217;appelle <tt class="docutils literal"><span class="pre">stylesheet</span></tt> et est inclu dans la balise <tt class="docutils literal"><span class="pre">head</span></tt>, et
l&#8217;autre s&#8217;appelle <tt class="docutils literal"><span class="pre">javascript</span></tt> et est inclu juste avant que la base <tt class="docutils literal"><span class="pre">body</span></tt> ne se
referme. Ces blocs contiendront toutes les feuilles de style et tous les
fichiers javascript dont vous aurez besoin pour votre site :</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span class="c">{# &#39;app/Resources/views/base.html.twig&#39; #}</span>
<span class="nt">&lt;html&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        <span class="c">{# ... #}</span>

        <span class="cp">{%</span> <span class="k">block</span> <span class="nv">stylesheets</span> <span class="cp">%}</span>
            <span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">asset</span><span class="o">(</span><span class="s1">&#39;/css/main.css&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span> <span class="nt">/&gt;</span>
        <span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>
        <span class="c">{# ... #}</span>

        <span class="cp">{%</span> <span class="k">block</span> <span class="nv">javascripts</span> <span class="cp">%}</span>
            <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">asset</span><span class="o">(</span><span class="s1">&#39;/js/main.js&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span> <span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
        <span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>
</div>
<p>C&#8217;est assez simple. Mais comment faire si vous avez besoin d&#8217;inclure une feuille
de style supplémentaire ou un autre fichier javascript à partir d&#8217;un template
enfant ? Par exemple, supposons que vous avez une page contact et que vous avez
besoin d&#8217;inclure une feuille de style <tt class="docutils literal"><span class="pre">contact.css</span></tt> uniquement sur cette
page. Au sein du template de la page contact, faites comme ce qui suit :</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span class="c">{# src/Acme/DemoBundle/Resources/views/Contact/contact.html.twig #}</span>
<span class="c">{# extends &#39;::base.html.twig&#39; #}</span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">stylesheets</span> <span class="cp">%}</span>
    <span class="cp">{{</span> <span class="nv">parent</span><span class="o">()</span> <span class="cp">}}</span>

    <span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">asset</span><span class="o">(</span><span class="s1">&#39;/css/contact.css&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span> <span class="nt">/&gt;</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>

<span class="c">{# ... #}</span>
</pre></div>
</div>
<p>Dans le template enfant, nous surchargeons simplement le bloc <tt class="docutils literal"><span class="pre">stylesheets</span></tt>
en ajoutant une nouvelle balise de feuille de style dans ce bloc. Bien sûr,
puisque nous voulons ajouter du contenu au bloc parent (et non le <em>remplacer</em>),
nous devons utiliser la fonction Twig <tt class="docutils literal"><span class="pre">parent()</span></tt> pour inclure le bloc
<tt class="docutils literal"><span class="pre">stylesheets</span></tt> du template de base.</p>
<p>Vous pouvez aussi inclure des ressources situées dans le dossier <tt class="docutils literal"><span class="pre">Resources/public</span></tt>
de vos bundles. Vous devrez lancer la commande <tt class="docutils literal"><span class="pre">php</span> <span class="pre">app/console</span> <span class="pre">assets:install</span> <span class="pre">target</span> <span class="pre">[--symlink]</span></tt>
pour placer les fichiers dans le bon répertoire (&#8220;web&#8221; par défaut)</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">asset</span><span class="o">(</span><span class="s1">&#39;bundles/acmedemo/css/contact.css&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
<p>Le résultat final est une page qui inclut à la fois la feuille de style
<tt class="docutils literal"><span class="pre">main.css</span></tt> et <tt class="docutils literal"><span class="pre">contact.css</span></tt>.</p>
</div>
<div class="section" id="configuration-et-utilisation-du-service-templating">
<span id="index-12"></span><h2>Configuration et Utilisation du Service <tt class="docutils literal"><span class="pre">templating</span></tt><a class="headerlink" href="#configuration-et-utilisation-du-service-templating" title="Permalink to this headline">¶</a></h2>
<p>Le coeur du système de template dans Symfony2 est le <tt class="docutils literal"><span class="pre">moteur</span></tt> de template (<tt class="docutils literal"><span class="pre">Engine</span></tt>). Cet
objet spécial est responsable de rendre des templates et de retourner leur
contenu. Quand vous effectuez le rendu d&#8217;un template à travers un contrôleur
par exemple, vous utilisez en effet le service de moteur de template. Par
exemple :</p>
<div class="highlight-php"><div class="highlight"><pre><span class="x">return $this-&gt;render(&#39;AcmeArticleBundle:Article:index.html.twig&#39;);</span>
</pre></div>
</div>
<p>est équivalent à</p>
<div class="highlight-php"><div class="highlight"><pre><span class="x">$engine = $this-&gt;container-&gt;get(&#39;templating&#39;);</span>
<span class="x">$content = $engine-&gt;render(&#39;AcmeArticleBundle:Article:index.html.twig&#39;);</span>

<span class="x">return $response = new Response($content);</span>
</pre></div>
</div>
<p id="template-configuration">Le moteur de template (ou « service ») est préconfiguré pour fonctionner
automatiquement dans Symfony2. Il peut, bien sûr, être configuré grâce au
fichier de configuration de l&#8217;application :</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/config.yml</span>
<span class="l-Scalar-Plain">framework</span><span class="p-Indicator">:</span>
    <span class="c1"># ...</span>
    <span class="l-Scalar-Plain">templating</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">engines</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="s">&#39;twig&#39;</span><span class="p-Indicator">]</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="c">&lt;!-- app/config/config.xml --&gt;</span>
<span class="nt">&lt;framework:templating&gt;</span>
    <span class="nt">&lt;framework:engine</span> <span class="na">id=</span><span class="s">&quot;twig&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/framework:templating&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="x">// app/config/config.php</span>
<span class="x">$container-&gt;loadFromExtension(&#39;framework&#39;, array(</span>
<span class="x">    // ...</span>
<span class="x">    &#39;templating&#39;      =&gt; array(</span>
<span class="x">        &#39;engines&#39; =&gt; array(&#39;twig&#39;),</span>
<span class="x">    ),</span>
<span class="x">));</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Plusieurs options de configuration sont disponibles et sont détaillées dans le
<a class="reference internal" href="../reference/configuration/framework.html"><em>Configuration Appendix</em></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Le moteur <tt class="docutils literal"><span class="pre">twig</span></tt> est nécessaire pour utiliser un webprofiler (de même que
beaucoup de bundles tiers).</p>
</div>
</div>
<div class="section" id="la-surcharge-de-templates-de-bundle">
<span id="overriding-bundle-templates"></span><span id="index-13"></span><h2>La Surcharge de templates de Bundle<a class="headerlink" href="#la-surcharge-de-templates-de-bundle" title="Permalink to this headline">¶</a></h2>
<p>La communauté Symfony2 est fière de créer et de maintenir des bundles de haute
qualité (voir <a class="reference external" href="http://knpbundles.com">KnpBundles.com</a>) concernant un grand nombre de fonctionnalités.
Une fois que vous utilisez un tel bundle, vous aimeriez surement surcharger et
personnaliser un ou plusieurs de ses templates.</p>
<p>Supposons que vous utilisiez un imaginaire <tt class="docutils literal"><span class="pre">AcmeBlogBundle</span></tt> open-source dans
votre projet (dans le répertoire <tt class="docutils literal"><span class="pre">src/Acme/blogBundle</span></tt> par exemple). Même si vous
êtes très content de ce bundle, vous voudriez probablement surcharger la page « liste » du
blog pour la personnaliser et l&#8217;adapter spécialement à votre application. En
cherchant un peu dans le contrôleur <tt class="docutils literal"><span class="pre">Blog</span></tt> du <tt class="docutils literal"><span class="pre">AcmeBlogBundle</span></tt>, vous trouvez ceci :</p>
<div class="highlight-php"><div class="highlight"><pre><span class="x">public function indexAction()</span>
<span class="x">{</span>
<span class="x">    $blogs = // logique qui récupère les blogs</span>

<span class="x">    $this-&gt;render(&#39;AcmeBlogBundle:Blog:index.html.twig&#39;, array(&#39;blogs&#39; =&gt; $blogs));</span>
<span class="x">}</span>
</pre></div>
</div>
<p>Quand le <tt class="docutils literal"><span class="pre">AcmeBlogBundle:Blog:index.html.twig</span></tt> est rendu, Symfony2 regarde en
fait dans deux emplacements pour le template :</p>
<ol class="arabic simple">
<li><tt class="docutils literal"><span class="pre">app/Resources/AcmeBlogBundle/views/Blog/index.html.twig</span></tt></li>
<li><tt class="docutils literal"><span class="pre">src/Acme/BlogBundle/Resources/views/Blog/index.html.twig</span></tt></li>
</ol>
<p>Pour surcharger le template du bundle, il suffit de copier le template
<tt class="docutils literal"><span class="pre">index.html.twig</span></tt> du bundle vers
<tt class="docutils literal"><span class="pre">app/Resources/AcmeBlogBundle/views/Blog/index.html.twig</span></tt> (le répertoire
<tt class="docutils literal"><span class="pre">app/Resources/AcmeBlogBundle</span></tt> n&#8217;existe pas, nous vous laissons le soin
de le créer). Vous êtes maintenant à même de personnaliser le template.</p>
<p>Cette logique s&#8217;applique aussi au template layout. Supposons maintenant que chaque
template dans <tt class="docutils literal"><span class="pre">AcmeBloqBundle</span></tt> hérite d&#8217;un template de base appelé
<tt class="docutils literal"><span class="pre">AcmeBlogBundle::layout.html.twig</span></tt>. Comme précédemment, Symfony2 regardera
dans les deux emplacements suivants :</p>
<ol class="arabic simple">
<li><tt class="docutils literal"><span class="pre">app/Resources/AcmeBlogBundle/views/layout.html.twig</span></tt></li>
<li><tt class="docutils literal"><span class="pre">src/Acme/BlogBundle/Resources/views/layout.html.twig</span></tt></li>
</ol>
<p>Encore une fois, pour surcharger le template, il suffit de le copier du bundle
vers <tt class="docutils literal"><span class="pre">app/Resources/AcmeBlogBundle/views/layout.html.twig</span></tt>. Vous êtes
maintenant libre de personnaliser cette copie comme il vous plaira.</p>
<p>Si vous prenez du recul, vous vous apercevrez que Symfony2 commence toujours
par regarder dans le répertoire <tt class="docutils literal"><span class="pre">app/Resources/{BUNDLE_NAME}/views/</span></tt> pour un
template. Si le template n&#8217;existe pas là, il continue sa recherche dans le
répertoire <tt class="docutils literal"><span class="pre">Resources/views</span></tt> du bundle lui-même. Ce qui signifie que tous les
templates d&#8217;un bundle peuvent être surchargés à condition de les placer dans le
bon sous-répertoire de <tt class="docutils literal"><span class="pre">app/Resources</span></tt>.</p>
<span class="target" id="templating-overriding-core-templates"></span><div class="section" id="la-surcharge-des-core-templates">
<span id="index-14"></span><h3>La Surcharge des Core Templates<a class="headerlink" href="#la-surcharge-des-core-templates" title="Permalink to this headline">¶</a></h3>
<p>Puisque le framework Symfony2 lui même est juste un bundle, les templates du noyau
peuvent être surchargés de la même façon. Par exemple, le bundle noyau
<tt class="docutils literal"><span class="pre">TwigBundle</span></tt> contient un certain nombre de templates relatifs aux
« exceptions » et aux « erreurs » qui peuvent être surchargés en copiant chacun d&#8217;eux
du répertoire <tt class="docutils literal"><span class="pre">Ressources/views/Exception</span></tt> du <tt class="docutils literal"><span class="pre">TwigBundle</span></tt> vers, vous
l&#8217;avez deviné, le répertoire <tt class="docutils literal"><span class="pre">app/Resources/TwigBundle/views/Exception</span></tt>.</p>
</div>
</div>
<div class="section" id="trois-niveaux-d-heritages">
<span id="index-15"></span><h2>Trois niveaux d&#8217;héritages<a class="headerlink" href="#trois-niveaux-d-heritages" title="Permalink to this headline">¶</a></h2>
<p>Une façon commune d&#8217;utiliser l&#8217;héritage est d&#8217;utiliser l&#8217;approche à trois
niveaux. Cette méthode fonctionne parfaitement avec trois différents types
de templates que nous détaillons :</p>
<ul>
<li><p class="first">Créez un fichier <tt class="docutils literal"><span class="pre">app/Resources/views/base.html.twig</span></tt> qui contient le
principal layout pour votre application (comme dans l&#8217;exemple précédent). En
interne, ce template est appelé <tt class="docutils literal"><span class="pre">::base.html.twig</span></tt>;</p>
</li>
<li><p class="first">Créez un template pour chaque « section » de votre site. Par exemple, un
<tt class="docutils literal"><span class="pre">AcmeBlogBundle</span></tt> devrait avoir un template appelé
<tt class="docutils literal"><span class="pre">AcmeBlogBundle::layout.html.twig</span></tt> qui contient uniquement les éléments de
section spécifiques au blog;</p>
<blockquote>
<div><div class="highlight-html+jinja"><div class="highlight"><pre><span class="c">{# src/Acme/BlogBundle/Resources/views/layout.html.twig #}</span>
<span class="cp">{%</span> <span class="k">extends</span> <span class="s1">&#39;::base.html.twig&#39;</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">body</span> <span class="cp">%}</span>
    <span class="nt">&lt;h1&gt;</span>Blog Application<span class="nt">&lt;/h1&gt;</span>

    <span class="cp">{%</span> <span class="k">block</span> <span class="nv">content</span> <span class="cp">%}{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Créez un template individuel pour chaque page et faites en sorte que chacun
étende (extend) le template approprié à la section. Par exemple, la page
« index » sera appelée à peu de chose près
<tt class="docutils literal"><span class="pre">AcmeBlogBundle:Blog:index.html.twig</span></tt> et listera les billets du blog.</p>
<blockquote>
<div><div class="highlight-html+jinja"><div class="highlight"><pre><span class="c">{# src/Acme/BlogBundle/Resources/views/Blog/index.html.twig #}</span>
<span class="cp">{%</span> <span class="k">extends</span> <span class="s1">&#39;AcmeBlogBundle::layout.html.twig&#39;</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">content</span> <span class="cp">%}</span>
    <span class="cp">{%</span> <span class="k">for</span> <span class="nv">entry</span> <span class="k">in</span> <span class="nv">blog_entries</span> <span class="cp">%}</span>
        <span class="nt">&lt;h2&gt;</span><span class="cp">{{</span> <span class="nv">entry.title</span> <span class="cp">}}</span><span class="nt">&lt;/h2&gt;</span>
        <span class="nt">&lt;p&gt;</span><span class="cp">{{</span> <span class="nv">entry.body</span> <span class="cp">}}</span><span class="nt">&lt;/p&gt;</span>
    <span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
<p>Remarquons que ce template étend la section (<tt class="docutils literal"><span class="pre">AcmeBlogBundle::layout.html.twig</span></tt>)
qui à son tour étend le layout de base de l&#8217;application (<tt class="docutils literal"><span class="pre">::base.html.twig</span></tt>).
C&#8217;est le modèle commun d&#8217;héritage à trois niveaux.</p>
<p>Quand vous construisez votre application, vous pouvez choisir de suivre cette
méthode ou simplement faire que chaque template de page étende le layout de
l&#8217;application directement (<tt class="docutils literal"><span class="pre">{%</span> <span class="pre">extends</span> <span class="pre">'::base.html.twig'</span> <span class="pre">%}</span></tt> par exemple). Le
modèle des trois templates est une meilleure pratique, utilisée par les bundles
vendor. De ce fait, le layout d&#8217;un bundle peut facilement être surchargé pour
étendre proprement le layout de base de votre application.</p>
</div>
<div class="section" id="l-echappement">
<span id="index-16"></span><h2>L&#8217;Echappement<a class="headerlink" href="#l-echappement" title="Permalink to this headline">¶</a></h2>
<p>Lors de la génération HTML d&#8217;un template, il y a toujours un risque qu&#8217;une
variable du template affiche du code HTML non désiré ou du code dangereux côté
client. Le résultat est que le contenu dynamique peut casser le code HTML de la
page résultante ou permettre à un utilisateur malicieux de réaliser une attaque
<a class="reference external" href="http://en.wikipedia.org/wiki/Cross-site_scripting">Cross Site Scripting</a> (XSS). Considérons cet exemple classique :</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-jinja"><div class="highlight"><pre><span class="x">Hello </span><span class="cp">{{</span> <span class="nv">name</span> <span class="cp">}}</span><span class="x"></span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="x">Hello </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$name</span> <span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Imaginons que l&#8217;utilisateur ait rentré le code suivant comme son nom :</p>
<div class="highlight-text"><div class="highlight"><pre>&lt;script&gt;alert(&#39;hello!&#39;)&lt;/script&gt;
</pre></div>
</div>
<p>Sans échappement du rendu, le template résultant provoquera l&#8217;affichage d&#8217;une boîte
d&#8217;alert Javascript :</p>
<div class="highlight-text"><div class="highlight"><pre>Hello &lt;script&gt;alert(&#39;hello!&#39;)&lt;/script&gt;
</pre></div>
</div>
<p>Et bien que cela semble inoffensif, si un utilisateur peut aller aussi loin, ce
même utilisateur peut aussi écrire un Javascript qui réalise des actions
malicieuses dans un espace sécurisé d&#8217;un inconnu et légitime utilisateur.</p>
<p>La réponse à ce problème est l&#8217;échappement (output escaping). En activant l&#8217;échappement,
le même template sera rendu de façon inoffensive, et affichera
littéralement la balise <tt class="docutils literal"><span class="pre">script</span></tt> à l&#8217;écran :</p>
<div class="highlight-text"><div class="highlight"><pre>Hello &amp;lt;script&amp;gt;alert(&amp;#39;helloe&amp;#39;)&amp;lt;/script&amp;gt;
</pre></div>
</div>
<p>Les systèmes de template Twig et PHP abordent le problème différemment. Si
vous utilisez Twig, l&#8217;échappement est activé par défaut et vous êtes protégé. En
PHP, l&#8217;échappement n&#8217;est pas automatique, ce qui signifie que vous aurez besoin
d&#8217;échapper manuellement là où c&#8217;est nécessaire.</p>
<div class="section" id="l-echappement-avec-twig">
<h3>L&#8217;échappement avec Twig<a class="headerlink" href="#l-echappement-avec-twig" title="Permalink to this headline">¶</a></h3>
<p>Si vous utilisez les templates Twig, alors l&#8217;échappement est activé par
défaut. Ce qui signifie que vous êtes protégé immédiatement des conséquences
non intentionnelles du code soumis par l&#8217;utilisateur. Par défaut, l&#8217;échappement
suppose que le contenu est bien échappé pour un affichage HTML.</p>
<p>Dans certains cas, vous aurez besoin de désactiver l&#8217;échappement de la sortie
lors du rendu d&#8217;une variable qui est sure et qui contient des décorations qui ne
doivent pas être échappées. Supposons que des utilisateurs administrateurs sont
capable décrire des articles qui contiennent du code HTML. Par défaut, Twig
échappera le corps de l&#8217;article. Pour le rendre normalement, il suffit
d&#8217;ajouter le filtre <tt class="docutils literal"><span class="pre">raw</span></tt> : <tt class="docutils literal"><span class="pre">{{</span> <span class="pre">article.body</span> <span class="pre">|</span> <span class="pre">raw</span> <span class="pre">}}</span></tt>.</p>
<p>Vous pouvez aussi désactiver l&#8217;échappement au sein d&#8217;un <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">block</span> <span class="pre">%}</span></tt> ou pour
un template entier, Pour plus d&#8217;informations, voir <a class="reference external" href="http://twig.sensiolabs.org/doc/api.html#escaper-extension">Output Escaping</a> dans la
documentation de Twig.</p>
</div>
<div class="section" id="l-echappement-en-php">
<h3>L&#8217;échappement en PHP<a class="headerlink" href="#l-echappement-en-php" title="Permalink to this headline">¶</a></h3>
<p>L&#8217;échappement n&#8217;est pas automatique lorsque vous utilisez des templates PHP. Ce
qui signife que, à moins que vous ne choisissiez explicitement d&#8217;échapper une
variable, vous n&#8217;êtes pas protégé. Pour utiliser l&#8217;échappement, utilisez la
méthode spéciale <tt class="docutils literal"><span class="pre">escape()</span></tt> de view : :</p>
<div class="highlight-php"><div class="highlight"><pre><span class="x">Hello </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="o">-&gt;</span><span class="na">escape</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
</div>
<p>Par défaut, la méthode <tt class="docutils literal"><span class="pre">escape()</span></tt> suppose que la variable est rendue dans un
contexte HTML (et donc que la variable est échappée pour être sans danger pour
l&#8217;HTML). Le second argument vous permet de changer de contexte. Par exemple,
pour afficher quelque chose dans une chaine de caractères JavaScript, utilisez le
context <tt class="docutils literal"><span class="pre">js</span></tt> :</p>
<div class="highlight-js"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">myMsg</span> <span class="o">=</span> <span class="s1">&#39;Hello &lt;?php echo $view-&gt;escape($name, &#39;</span><span class="nx">js</span><span class="s1">&#39;) ?&gt;&#39;</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="les-formats-de-template">
<span id="template-formats"></span><span id="index-17"></span><h2>Les Formats de Template<a class="headerlink" href="#les-formats-de-template" title="Permalink to this headline">¶</a></h2>
<p>Les templates sont une façon générique de rendre un contenu dans <em>n&#8217;importe
quel</em> format. Et bien que dans la plupart des cas vous utiliserez les templates
pour rendre du contenu HTML, un template peut tout aussi facilement générer du
JavaScript, du CSS, du XML ou tout autre format dont vous pouvez rêver.</p>
<p>Par exemple, la même « ressource » est souvent rendue dans plusieurs formats
différents. Pour rendre la page index d&#8217;un article en XML, incluez simplement le
format dans le nom du template :</p>
<ul class="simple">
<li><em>nom du template XML</em>: <tt class="docutils literal"><span class="pre">AcmeArticleBundle:Article:index.xml.twig</span></tt></li>
<li><em>nom de fichier du template XML</em>: <tt class="docutils literal"><span class="pre">index.xml.twig</span></tt></li>
</ul>
<p>En réalité, ce n&#8217;est rien de plus qu&#8217;une convention de nommage et le template
n&#8217;est pas rendu différemment en se basant sur ce format.</p>
<p>Dans beaucoup de cas, vous pourriez vouloir autoriser un simple contrôleur à
rendre plusieurs formats en se basant sur le « request format ». Pour cette
raison, un pattern commun est de procéder comme cela :</p>
<div class="highlight-php"><div class="highlight"><pre><span class="x">public function indexAction()</span>
<span class="x">{</span>
<span class="x">    $format = $this-&gt;getRequest()-&gt;getRequestFormat();</span>

<span class="x">    return $this-&gt;render(&#39;AcmeBlogBundle:Blog:index.&#39;.$format.&#39;.twig&#39;);</span>
<span class="x">}</span>
</pre></div>
</div>
<p>Le <tt class="docutils literal"><span class="pre">getRequestFormat</span></tt> sur l&#8217;objet <tt class="docutils literal"><span class="pre">Request</span></tt> retourne par défaut <tt class="docutils literal"><span class="pre">html</span></tt>,
mais peut aussi retourner n&#8217;importe quel autre format basé sur le format demandé
par l&#8217;utilisateur. Le format demandé est le plus souvent géré par le système de
route, où une route peut être configurée telle que <tt class="docutils literal"><span class="pre">/contact</span></tt> définit le format
demandé à <tt class="docutils literal"><span class="pre">html</span></tt> alors que <tt class="docutils literal"><span class="pre">/contact.xml</span></tt> définit le format à <tt class="docutils literal"><span class="pre">xml</span></tt>. Pour
plus d&#8217;informations, voir l&#8217;<a class="reference internal" href="routing.html#advanced-routing-example"><em>Exemple avancé du chapitre routing</em></a>.</p>
<p>Pour créer des liens qui incluent le paramètre de format, incluez une clé
<tt class="docutils literal"><span class="pre">_format</span></tt> dans le tableau de paramètres :</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-html+jinja"><div class="highlight"><pre><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">path</span><span class="o">(</span><span class="s1">&#39;article_show&#39;</span><span class="o">,</span> <span class="o">{</span><span class="s1">&#39;id&#39;</span><span class="o">:</span> <span class="m">123</span><span class="o">,</span> <span class="s1">&#39;_format&#39;</span><span class="o">:</span> <span class="s1">&#39;pdf&#39;</span><span class="o">})</span> <span class="cp">}}</span><span class="s">&quot;</span><span class="nt">&gt;</span>
    PDF Version
<span class="nt">&lt;/a&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-html+php"><div class="highlight"><pre><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;router&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">generate</span><span class="p">(</span><span class="s1">&#39;article_show&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;id&#39;</span> <span class="o">=&gt;</span> <span class="mi">123</span><span class="p">,</span> <span class="s1">&#39;_format&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;pdf&#39;</span><span class="p">))</span> <span class="cp">?&gt;</span><span class="s">&quot;</span><span class="nt">&gt;</span>
    PDF Version
<span class="nt">&lt;/a&gt;</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="reflexions-finales">
<h2>Réflexions Finales<a class="headerlink" href="#reflexions-finales" title="Permalink to this headline">¶</a></h2>
<p>Le moteur de template dans Symfony est un outil puissant qui peut être utilisé
chaque fois que vous avez besoin de générer du contenu de répresentation en
HTML, XML ou tout autre format. Et bien que les templates soient un moyen commun
de générer du contenu dans un contrôleur, leur utilisation n&#8217;est pas
systèmatique. L&#8217;objet <tt class="docutils literal"><span class="pre">Response</span></tt> retourné par un contrôleur peut être créé
avec ou sans utilisation de template :</p>
<div class="highlight-php"><div class="highlight"><pre><span class="x">// création d&#39;un objet Response qui contient le rendu d&#39;un template</span>
<span class="x">$response = $this-&gt;render(&#39;AcmeArticleBundle:Article:index.html.twig&#39;);</span>

<span class="x">// création d&#39;un objet Response qui contient un texte simple</span>
<span class="x">$response = new Response(&#39;response content&#39;);</span>
</pre></div>
</div>
<p>Le moteur de templates de Symfony est très flexible et deux outils de restition
sont disponibles par défaut : les traditionnels templates <em>PHP</em> et les élégants
et puissants templates <em>Twig</em>. Ils supportent tout les deux une hiérarchie des
template et sont fournis avec un ensemble riche de fonctions capables de
réaliser la plupart des tâches.</p>
<p>Dans l&#8217;ensemble, le système de templates doit être pensé comme étant un outil
puissant qui est à votre disposition. Dans certains cas, vous n&#8217;aurez pas besoin
de rendre un template, et dans Symfony2, c&#8217;est tout à fait envisageable.</p>
</div>
<div class="section" id="en-savoir-plus-grace-au-cookbook">
<h2>En savoir plus grâce au Cookbook<a class="headerlink" href="#en-savoir-plus-grace-au-cookbook" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference internal" href="../cookbook/templating/PHP.html"><em>How to use PHP instead of Twig for Templates</em></a></li>
<li><a class="reference internal" href="../cookbook/controller/error_pages.html"><em>How to customize Error Pages</em></a></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Créer et utiliser les templates</a><ul>
<li><a class="reference internal" href="#templates">Templates</a><ul>
<li><a class="reference internal" href="#twig-et-la-mise-en-cache">Twig et la mise en cache</a></li>
</ul>
</li>
<li><a class="reference internal" href="#l-heritage-de-template-et-layouts">L&#8217;héritage de template et layouts</a></li>
<li><a class="reference internal" href="#nommage-de-template-et-emplacements">Nommage de template et Emplacements</a><ul>
<li><a class="reference internal" href="#les-suffixes-de-template">Les Suffixes de Template</a></li>
</ul>
</li>
<li><a class="reference internal" href="#balises-et-helpers">Balises et Helpers</a><ul>
<li><a class="reference internal" href="#l-inclusion-de-templates">L&#8217;inclusion de Templates</a></li>
<li><a class="reference internal" href="#controleurs-imbriques">Contrôleurs imbriqués</a></li>
<li><a class="reference internal" href="#liens-vers-des-pages">Liens vers des Pages</a></li>
<li><a class="reference internal" href="#liens-vers-des-fichiers">Liens vers des Fichiers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#l-inclusion-de-feuilles-de-style-et-de-javascripts-avec-twig">L&#8217;inclusion de Feuilles de style et de Javascripts avec Twig</a></li>
<li><a class="reference internal" href="#configuration-et-utilisation-du-service-templating">Configuration et Utilisation du Service <tt class="docutils literal"><span class="pre">templating</span></tt></a></li>
<li><a class="reference internal" href="#la-surcharge-de-templates-de-bundle">La Surcharge de templates de Bundle</a><ul>
<li><a class="reference internal" href="#la-surcharge-des-core-templates">La Surcharge des Core Templates</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trois-niveaux-d-heritages">Trois niveaux d&#8217;héritages</a></li>
<li><a class="reference internal" href="#l-echappement">L&#8217;Echappement</a><ul>
<li><a class="reference internal" href="#l-echappement-avec-twig">L&#8217;échappement avec Twig</a></li>
<li><a class="reference internal" href="#l-echappement-en-php">L&#8217;échappement en PHP</a></li>
</ul>
</li>
<li><a class="reference internal" href="#les-formats-de-template">Les Formats de Template</a></li>
<li><a class="reference internal" href="#reflexions-finales">Réflexions Finales</a></li>
<li><a class="reference internal" href="#en-savoir-plus-grace-au-cookbook">En savoir plus grâce au Cookbook</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="routing.html"
                        title="previous chapter">Routage</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="doctrine.html"
                        title="next chapter">Doctrine et les bases de données (« Le Modèle »)</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/book/templating.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="doctrine.html" title="Doctrine et les bases de données (« Le Modèle »)"
             >next</a> |</li>
        <li class="right" >
          <a href="routing.html" title="Routage"
             >previous</a> |</li>
        <li><a href="../index.html">sf2doc 1.0 documentation</a> &raquo;</li>
          <li><a href="index.html" >Book</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, sf2.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
  </body>
</html>